"""
Обратный просмотр DNS — обращение к особой доменной зоне для определения
имени узла (устройство, соединённое с другими устройствами как часть сети) по
его IP-адресу c помощью PTR-записи.
Фактически PTR означает POINTER, и является уникальной записью в системе
DNS, которая связывает IP-адрес с каноническим именем хоста. Практически
PTR-запись является частью системы DNS, но создается с помощью
специального файла зоны с классическим форматом in-addr.arpa.
На одном и том же IP-адресе может быть множество хостов. И если в файле
конфигурации не указана обратная зона, то определить имя узла таким образом
не получится.
"""
import dns
import re


def reverse_dns():
    ip = input('Enter IP: ')
    while re.fullmatch(
            r'(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)', ip) is None:
        print('\nIP-address format is XXX.XXX.XXX.XXX with the maximum value of XXX as 255.\n')
        ip = input('Enter IP: ')
    else:
        try:
            rev_name = dns.reversename.from_address(ip)
            reversed_dns = str(dns.resolver.query(rev_name, 'PTR')[0])
        except Exception as e:
            return f'\n{ip} ERROR --- {e}\n'
        else:
            return f'{ip}: {reversed_dns}'
