"""
Sitemap — это файл со ссылками на страницы сайта, который сообщает
поисковым системам об актуальной структуре сайта. Поддерживает форматы XML
и TXT. В реальности формат txt довольно редко используется на практике для
составления карты сайта. В код не вошла проверка sitemap.txt, но при желании её
можно легко добавить.
Для пентестера наличие карты сайта облегчает понимание объёма сайта, а также
представляет отличный ссылочный материал для проверки на уязвимости, без
необходимости парсить сайт.
"""
import requests
from bs4 import BeautifulSoup
import re


def validation():
    link = input('Enter host [http://site.com] or [https://site.com]: ')
    while not re.fullmatch(r'https?://[\d\-_.~a-z]+\.[a-z]{2,}', link):
        print('\nPlease enter a host by the pattern [http://site.com] or [https://site.com] !!!\n')
        link = input('Enter host [http://site.com] or [https://site.com]: ')

    return link


def get_page_data():
    url = validation()
    try:
        page = requests.get(f'{url}/sitemap.xml')
    except requests.exceptions.ConnectionError:
        return f'\nThe website {url} not found.'
    except Exception as e:
        return f'\n{url} ERROR --- {e}'
    else:
        if page.status_code == 200:
            res = BeautifulSoup(page.text, 'html.parser')
            line = res.find_all('loc')
            results = []
            for i in line:
                results.append(i.text)
            return '\n'.join(results)
        else:
            return f'\nFile "sitemap.xml" not found for {url}!'
